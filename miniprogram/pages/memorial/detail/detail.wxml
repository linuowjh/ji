<!--pages/memorial/detail/detail.wxml-->
<view class="container" wx:if="{{!loading && memorial}}">
  <!-- çºªå¿µé¦†å¤´éƒ¨ -->
  <view class="memorial-header solemn-bg">
    <image class="memorial-avatar" src="{{memorial.avatarUrl}}" mode="aspectFill" bindtap="previewImage" data-url="{{memorial.avatarUrl}}"></image>
    <text class="memorial-name solemn-text">{{memorial.deceasedName}}</text>
    <text class="memorial-dates">{{memorial.birthDate}} - {{memorial.deathDate}}</text>
    <text class="memorial-epitaph" wx:if="{{memorial.epitaph}}">{{memorial.epitaph}}</text>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-worship" bindtap="goToWorship">
      <text class="btn-icon">ğŸ•¯ï¸</text>
      <text class="btn-text">ç¥­æ‰«</text>
    </button>
    <button class="btn-edit" bindtap="editMemorial">
      <text class="btn-icon">âœï¸</text>
      <text class="btn-text">ç¼–è¾‘</text>
    </button>
    <button class="btn-share" open-type="share">
      <text class="btn-icon">ğŸ“¤</text>
      <text class="btn-text">åˆ†äº«</text>
    </button>
  </view>

  <!-- ç”Ÿå¹³ç®€ä»‹ -->
  <view class="section card" wx:if="{{memorial.biography}}">
    <view class="section-title">ç”Ÿå¹³ç®€ä»‹</view>
    <text class="biography-text">{{memorial.biography}}</text>
  </view>

  <!-- è™šæ‹Ÿå¢“ç¢‘ -->
  <view class="section card" wx:if="{{memorial.tombstoneStyle}}">
    <view class="section-title">è™šæ‹Ÿå¢“ç¢‘</view>
    <view class="tombstone {{memorial.tombstoneStyle}}">
      <text class="tombstone-text">{{memorial.epitaph || memorial.deceasedName}}</text>
    </view>
  </view>

  <!-- æœ€è¿‘ç¥­æ‰« -->
  <view class="section card" wx:if="{{recentWorship.length > 0}}">
    <view class="section-title">æœ€è¿‘ç¥­æ‰«</view>
    <view class="worship-list">
      <view class="worship-item" wx:for="{{recentWorship}}" wx:key="id">
        <image class="worship-avatar" src="{{item.userAvatar}}" mode="aspectFill"></image>
        <view class="worship-content">
          <text class="worship-user">{{item.userName}}</text>
          <text class="worship-action">{{item.worshipTypeText}}</text>
          <text class="worship-time">{{item.createdAt}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="section card">
    <view class="section-title">ç»Ÿè®¡ä¿¡æ¯</view>
    <view class="stats-grid">
      <view class="stat-box">
        <text class="stat-value">{{memorial.worshipCount || 0}}</text>
        <text class="stat-label">ç¥­æ‰«æ¬¡æ•°</text>
      </view>
      <view class="stat-box">
        <text class="stat-value">{{memorial.visitorCount || 0}}</text>
        <text class="stat-label">è®¿å®¢äººæ•°</text>
      </view>
      <view class="stat-box">
        <text class="stat-value">{{memorial.prayerCount || 0}}</text>
        <text class="stat-label">ç¥ˆç¦ç•™è¨€</text>
      </view>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:if="{{loading}}">
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>
