<!--pages/family/detail/detail.wxml-->
<view class="container" wx:if="{{family}}">
  <!-- 家族圈头部 -->
  <view class="family-header solemn-bg">
    <text class="family-name solemn-text">{{family.name}}</text>
    <text class="family-desc">{{family.description}}</text>
    <view class="family-stats">
      <view class="stat-item">
        <text class="stat-value solemn-text">{{family.memberCount || 0}}</text>
        <text class="stat-label">成员</text>
      </view>
      <view class="stat-item">
        <text class="stat-value solemn-text">{{family.memorialCount || 0}}</text>
        <text class="stat-label">纪念馆</text>
      </view>
      <view class="stat-item">
        <text class="stat-value solemn-text">{{family.activityCount || 0}}</text>
        <text class="stat-label">动态</text>
      </view>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-bar">
    <button class="btn-invite" bindtap="inviteMember">邀请成员</button>
  </view>

  <!-- 标签切换 -->
  <view class="tabs">
    <view class="tab-item {{activeTab === 'activity' ? 'active' : ''}}" bindtap="switchTab" data-tab="activity">
      动态
    </view>
    <view class="tab-item {{activeTab === 'member' ? 'active' : ''}}" bindtap="switchTab" data-tab="member">
      成员
    </view>
  </view>

  <!-- 动态列表 -->
  <view class="activity-list" wx:if="{{activeTab === 'activity'}}">
    <view class="activity-item" wx:for="{{activities}}" wx:key="id">
      <image class="activity-avatar" src="{{item.userAvatar}}" mode="aspectFill"></image>
      <view class="activity-content">
        <text class="activity-user">{{item.userName}}</text>
        <text class="activity-action">{{item.actionText}}</text>
        <text class="activity-time">{{item.createdAt}}</text>
      </view>
    </view>
    <view class="empty" wx:if="{{activities.length === 0}}">
      <text class="empty-text">暂无动态</text>
    </view>
  </view>

  <!-- 成员列表 -->
  <view class="member-list" wx:if="{{activeTab === 'member'}}">
    <view class="member-item" wx:for="{{members}}" wx:key="id">
      <image class="member-avatar" src="{{item.user.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="member-info">
        <text class="member-name">{{item.user.nickname || '未知用户'}}</text>
        <text class="member-role">加入时间：{{item.joinedAt}}</text>
      </view>
      <view class="member-badge" wx:if="{{item.role === 'admin'}}">
        <text class="badge-text">管理员</text>
      </view>
    </view>
    <view class="empty" wx:if="{{members.length === 0}}">
      <text class="empty-text">暂无成员</text>
    </view>
  </view>
</view>
