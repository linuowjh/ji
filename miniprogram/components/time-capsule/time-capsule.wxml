<!--components/time-capsule/time-capsule.wxml-->
<view class="time-capsule">
  <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  <view class="message-item" wx:for="{{messages}}" wx:key="id">
    <view class="message-header">
      <image class="message-avatar" src="{{item.userAvatar}}" mode="aspectFill"></image>
      <view class="message-user-info">
        <text class="message-username">{{item.userName}}</text>
        <text class="message-time">{{item.createdAt}}</text>
      </view>
      <view class="message-type-badge {{item.type}}">
        <text wx:if="{{item.type === 'voice'}}">è¯­éŸ³</text>
        <text wx:elif="{{item.type === 'video'}}">è§†é¢‘</text>
      </view>
    </view>

    <view class="message-content">
      <!-- è¯­éŸ³æ¶ˆæ¯ -->
      <view class="voice-player" wx:if="{{item.type === 'voice'}}">
        <button class="play-btn" bindtap="playVoice" data-url="{{item.mediaUrl}}">
          <text class="play-icon">â–¶ï¸</text>
        </button>
        <view class="voice-info">
          <text class="voice-duration">{{item.duration}}ç§’</text>
        </view>
      </view>

      <!-- è§†é¢‘æ¶ˆæ¯ -->
      <view class="video-cover" wx:if="{{item.type === 'video'}}" bindtap="playVideo" data-url="{{item.mediaUrl}}">
        <image class="video-thumbnail" src="{{item.thumbnailUrl}}" mode="aspectFill"></image>
        <view class="video-play-btn">
          <text class="video-play-icon">â–¶ï¸</text>
        </view>
      </view>

      <!-- æ–‡å­—å†…å®¹ -->
      <text class="message-text" wx:if="{{item.content}}">{{item.content}}</text>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{messages.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“®</text>
    <text class="empty-text">æ—¶å…‰ä¿¡ç®±ç©ºç©ºå¦‚ä¹Ÿ</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>
